{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://standard.aimoaas.com/schemas/agent-activity.schema.json",
  "title": "Agent Activity Log Schema",
  "description": "Vendor-neutral schema for agentic AI activity logs. Supports evidence collection for autonomous agent privilege exercise, tool execution, and recursive operations.",
  "type": "object",
  "required": [
    "event_time",
    "agent_id",
    "agent_version",
    "run_id",
    "event_type",
    "actor_id",
    "tool_name",
    "tool_action",
    "tool_target",
    "auth_context",
    "input_ref",
    "output_ref",
    "decision",
    "evidence_ref"
  ],
  "properties": {
    "event_time": {
      "type": "string",
      "format": "date-time",
      "minLength": 1,
      "description": "ISO8601 timestamp of the event"
    },
    "agent_id": {
      "type": "string",
      "minLength": 1,
      "description": "Identifier of the agent"
    },
    "agent_version": {
      "type": "string",
      "minLength": 1,
      "description": "Version of the agent"
    },
    "run_id": {
      "type": "string",
      "minLength": 1,
      "description": "Unique identifier for this agent run/session"
    },
    "event_type": {
      "type": "string",
      "enum": ["agent_run", "tool_call", "tool_result", "escalation"],
      "description": "Type of agent event"
    },
    "actor_id": {
      "type": "string",
      "minLength": 1,
      "description": "Identifier of the initiating user or service"
    },
    "tool_name": {
      "type": "string",
      "minLength": 1,
      "description": "Name of the tool being invoked"
    },
    "tool_action": {
      "type": "string",
      "minLength": 1,
      "description": "Action performed by the tool"
    },
    "tool_target": {
      "type": "string",
      "minLength": 1,
      "description": "Target of the tool action (e.g., file path, API endpoint)"
    },
    "auth_context": {
      "type": "string",
      "minLength": 1,
      "description": "Permission/role summary for this action"
    },
    "input_ref": {
      "type": "string",
      "minLength": 1,
      "description": "Hash or URI reference to input (do not embed secrets)"
    },
    "output_ref": {
      "type": "string",
      "minLength": 1,
      "description": "Hash or URI reference to output (do not embed secrets)"
    },
    "decision": {
      "type": "string",
      "enum": ["allow", "block", "needs_review", "unknown"],
      "description": "Policy decision applied to the action"
    },
    "evidence_ref": {
      "type": "string",
      "minLength": 1,
      "description": "URI or hash reference to related evidence"
    },
    "recursion_depth": {
      "type": "number",
      "description": "Current recursion depth for nested agent calls"
    },
    "retry_count": {
      "type": "number",
      "description": "Number of retries for this action"
    },
    "policy_id": {
      "type": "string",
      "description": "Policy identifier that triggered the decision"
    },
    "prompt_template_id": {
      "type": "string",
      "description": "Prompt template identifier"
    },
    "model": {
      "type": "string",
      "description": "Model used for this action"
    },
    "latency_ms": {
      "type": "number",
      "description": "Latency in milliseconds"
    },
    "cost_estimate": {
      "type": "number",
      "description": "Estimated cost of this action"
    },
    "error_code": {
      "type": "string",
      "description": "Error code if the action failed"
    }
  },
  "additionalProperties": true
}
